import React, { useState, useEffect } from 'react';

export default function App() {
  const [data, setData] = useState(initData);
  const [region, setRegion] = useState(Object.keys(regions)[0]);
  const [genre, setGenre] = useState(genres[0]);

  const fetchData = (updt?: boolean) => {
    if (regions[region].includes(genre)) {
      const f = updt ? '&updt=true' : '';
      const key = `/api?region=${region}&genre=${genre}${f}`;
      fetch(key).then((res) => res.json()).then((data) => {
        setData((prevData) => { return { ...prevData, [region]: data } });
      });
    } else {
      setData((prevData) => { return { ...prevData, [region]: 'not found' } });
    }
  }

  useEffect(() => { fetchData(); }, [region, genre]);

  return (
    <>
      <select onChange={e => setRegion(e.target.value)}>
        {...Object.keys(regions)
          .map((e, i) => <option key={i} value={e}>{e}</option>)}
      </select>
      <select onChange={e => setGenre(e.target.value)}>
        {...genres
          .map((e, i) => <option key={i} value={e}>{e}</option>)}
      </select>
      <button>update</button>
      {JSON.stringify(data)}
    </>
  )
}

const initData = {
  '大阪府': {},
  '豊中市': {},
  '茨木市': {},
  '堺市': {},
  '高石市': {},
  '大阪狭山市': {},
  '熊取町': {},
  '池田市': {},
  '東大阪市': {},
  '吹田市': {},
  '和泉市': {},
  '高槻市': {},
  '河内長野市': {},
  '大阪市': {},
  '富田林市': {},
  '河南町': {},
  '太子町': {},
  '千早赤阪村': {},
};

const genres = [
  'バレーボール',
  'バスケットボール',
  'バドミントン',
  '卓球',
  'テニス',
  '体操',
  'ダンス・エクササイズ',
  '武道',
  '野球・ソフトボール',
  'サッカー',
  'ニュースポーツ',
  '陸上・跳躍・投擲',
  '競技会・運動会',
  '文化利用・会議（スポーツ）',
  'レクリエーション',
  'その他球技',
  'その他スポーツ',
  'その他',
];

const regions = {
  '大阪府': [
    'テニス',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '陸上・跳躍・投擲',
    '競技会・運動会',
    'その他球技',
  ],
  '豊中市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
  ],
  '茨木市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
  ],
  '堺市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '陸上・跳躍・投擲',
    '文化利用・会議（スポーツ）',
    'その他球技',
    'その他スポーツ',
    'その他',
  ],
  '高石市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'その他球技',
    'その他',
  ],
  '大阪狭山市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '陸上・跳躍・投擲',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
  ],
  '熊取町': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    'サッカー',
    'ニュースポーツ',
    '文化利用・会議（スポーツ）',
    'その他球技',
  ],
  '池田市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '陸上・跳躍・投擲',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
    'その他',
  ],
  '東大阪市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '文化利用・会議（スポーツ）',
    'その他球技',
    'その他スポーツ',
    'その他',
  ],
  '吹田市': [
    'その他球技',
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他スポーツ',
    'その他',
  ],
  '和泉市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '文化利用・会議（スポーツ）',
    'その他',
  ],
  '高槻市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '陸上・跳躍・投擲',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
    'その他スポーツ',
  ],
  '河内長野市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
  ],
  '大阪市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'その他球技',
    'その他',
  ],
  '富田林市': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '陸上・跳躍・投擲',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
    'その他スポーツ',
    'その他',
  ],
  '河南町': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '陸上・跳躍・投擲',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
    'その他',
  ],
  '太子町': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '文化利用・会議（スポーツ）',
    'その他球技',
  ],
  '千早赤阪村': [
    'バレーボール',
    'バスケットボール',
    'バドミントン',
    '卓球',
    'テニス',
    '体操',
    'ダンス・エクササイズ',
    '武道',
    '野球・ソフトボール',
    'サッカー',
    'ニュースポーツ',
    '競技会・運動会',
    '文化利用・会議（スポーツ）',
    'レクリエーション',
    'その他球技',
  ],
};